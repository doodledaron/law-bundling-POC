Early stopping enabled with patience=8, min_delta=0.0001
Training started at: 2025-04-20 11:02:56
Parameters: {'dataset_dir': 'CUAD_v1/layoutlmv3_dataset', 'output_dir': 'layoutlmv3/model/train-20250420_110256', 'model_name': 'microsoft/layoutlmv3-base', 'processor_dir': None, 'batch_size': 8, 'learning_rate': 5e-06, 'num_epochs': 100, 'max_seq_length': 512, 'warmup_ratio': 0.1, 'weight_decay': 0.01, 'save_steps': 100, 'eval_steps': 100, 'checkpoint_steps': 500, 'seed': 42, 'device': 'cuda', 'num_workers': 0, 'resume_from': None, 'early_stopping': True, 'patience': 8, 'min_delta': 0.0001}
Loading model microsoft/layoutlmv3-base...
Creating new processor with OCR disabled...
Saving processor to layoutlmv3/model/train-20250420_110256/processor...
Creating data loaders (batch_size=8, num_workers=0)...
Starting/Resuming training with 3600 total steps...
Epoch 1/100
Epoch 1 average loss: 3.6916
Evaluating after epoch 1...
Evaluation results: {'precision': 0.09990905132788681, 'recall': 0.029918864097363083, 'f1': 0.019383649476294937}
Saving checkpoint at end of epoch 1...
Epoch 2/100
Epoch 2 average loss: 3.6660
Evaluating after epoch 2...
Evaluation results: {'precision': 0.09579466670423406, 'recall': 0.04158215010141988, 'f1': 0.01802256702785063}
Saving checkpoint at end of epoch 2...
Epoch 3/100
Step 100/3600 - Loss: 1.0143

Evaluating at step 100... (Time: 2025-04-20 11:05:47)
Evaluation results: {'precision': 0.06499118081722945, 'recall': 0.05273833671399594, 'f1': 0.018611608546163068}
New best F1: 0.0186, saving model...
Epoch 3 average loss: 3.6099
Evaluating after epoch 3...
Evaluation results: {'precision': 0.034070838697268915, 'recall': 0.05628803245436106, 'f1': 0.018969358800807423}
Saving checkpoint at end of epoch 3...
Epoch 4/100
Epoch 4 average loss: 3.5369
Evaluating after epoch 4...
Evaluation results: {'precision': 0.05100498958842946, 'recall': 0.06135902636916836, 'f1': 0.015624979264242682}
Saving checkpoint at end of epoch 4...
Epoch 5/100
Epoch 5 average loss: 3.4050
Evaluating after epoch 5...
Evaluation results: {'precision': 0.041576406115611926, 'recall': 0.07860040567951318, 'f1': 0.02820206378885835}
Saving checkpoint at end of epoch 5...
Epoch 6/100
Step 200/3600 - Loss: 0.3264

Evaluating at step 200... (Time: 2025-04-20 11:08:47)
Evaluation results: {'precision': 0.011103145293908856, 'recall': 0.0704868154158215, 'f1': 0.018070007169935825}
Epoch 6 average loss: 3.2554
Evaluating after epoch 6...
Evaluation results: {'precision': 0.044268638347214714, 'recall': 0.08975659229208925, 'f1': 0.030249439845360108}
Saving checkpoint at end of epoch 6...
Epoch 7/100
Epoch 7 average loss: 3.1848
Evaluating after epoch 7...
Evaluation results: {'precision': 0.028117470256946064, 'recall': 0.1191683569979716, 'f1': 0.037395355786857036}
Saving checkpoint at end of epoch 7...
Epoch 8/100
Epoch 8 average loss: 3.0935
Evaluating after epoch 8...
Evaluation results: {'precision': 0.02377068896774839, 'recall': 0.1262677484787018, 'f1': 0.03954670339761177}
Saving checkpoint at end of epoch 8...
Epoch 9/100
Step 300/3600 - Loss: 0.1200

Evaluating at step 300... (Time: 2025-04-20 11:11:48)
Evaluation results: {'precision': 0.027696959361389602, 'recall': 0.12119675456389452, 'f1': 0.04287851973590226}
New best F1: 0.0429, saving model...
Epoch 9 average loss: 2.9895
Evaluating after epoch 9...
Evaluation results: {'precision': 0.020900768048347586, 'recall': 0.1105476673427992, 'f1': 0.03441726681587965}
Saving checkpoint at end of epoch 9...
Epoch 10/100
Epoch 10 average loss: 2.9037
Evaluating after epoch 10...
Evaluation results: {'precision': 0.07739825721966952, 'recall': 0.12981744421906694, 'f1': 0.06929839442403252}
Saving checkpoint at end of epoch 10...
Epoch 11/100
Epoch 11 average loss: 2.8473
Evaluating after epoch 11...
Evaluation results: {'precision': 0.08092412602463508, 'recall': 0.13640973630831643, 'f1': 0.08035935581890899}
Saving checkpoint at end of epoch 11...
Epoch 12/100
Step 400/3600 - Loss: 0.0296

Evaluating at step 400... (Time: 2025-04-20 11:14:36)
Evaluation results: {'precision': 0.06039767014070361, 'recall': 0.12474645030425964, 'f1': 0.06616466857866025}
New best F1: 0.0662, saving model...
Epoch 12 average loss: 2.7134
Evaluating after epoch 12...
Evaluation results: {'precision': 0.04335524759657894, 'recall': 0.13133874239350912, 'f1': 0.06277545282338111}
Saving checkpoint at end of epoch 12...
Epoch 13/100
Epoch 13 average loss: 2.6350
Evaluating after epoch 13...
Evaluation results: {'precision': 0.04595335288926022, 'recall': 0.1323529411764706, 'f1': 0.06646714872890816}
Saving checkpoint at end of epoch 13...
Epoch 14/100
Step 500/3600 - Loss: 0.1592

Evaluating at step 500... (Time: 2025-04-20 11:16:50)
Evaluation results: {'precision': 0.048626555369859825, 'recall': 0.13793103448275862, 'f1': 0.06987540444822263}
New best F1: 0.0699, saving model...
Epoch 14 average loss: 2.4668
Evaluating after epoch 14...
Evaluation results: {'precision': 0.04562186464652613, 'recall': 0.11815415821501014, 'f1': 0.06571931009957818}
Saving checkpoint at end of epoch 14...
Epoch 15/100
Epoch 15 average loss: 2.3856
Evaluating after epoch 15...
Evaluation results: {'precision': 0.10270925091913084, 'recall': 0.13387423935091278, 'f1': 0.08756753777747842}
Saving checkpoint at end of epoch 15...
Epoch 16/100
Epoch 16 average loss: 2.3144
Evaluating after epoch 16...
Evaluation results: {'precision': 0.1176490882165172, 'recall': 0.1830628803245436, 'f1': 0.1185116661501499}
Saving checkpoint at end of epoch 16...
Epoch 17/100
Step 600/3600 - Loss: 0.0839

Evaluating at step 600... (Time: 2025-04-20 11:19:39)
Evaluation results: {'precision': 0.06741541380362558, 'recall': 0.12525354969574037, 'f1': 0.07930600392965854}
New best F1: 0.0793, saving model...
Epoch 17 average loss: 2.0593
Evaluating after epoch 17...
Evaluation results: {'precision': 0.07051217812714432, 'recall': 0.11359026369168357, 'f1': 0.07721460088375359}
Saving checkpoint at end of epoch 17...
Epoch 18/100
Epoch 18 average loss: 2.0654
Evaluating after epoch 18...
Evaluation results: {'precision': 0.18056710168280907, 'recall': 0.17494929006085191, 'f1': 0.15434339370868652}
Saving checkpoint at end of epoch 18...
Epoch 19/100
Epoch 19 average loss: 1.8928
Evaluating after epoch 19...
Evaluation results: {'precision': 0.09182439916396679, 'recall': 0.140973630831643, 'f1': 0.09867205900231171}
Saving checkpoint at end of epoch 19...
Epoch 20/100
Step 700/3600 - Loss: 0.0392

Evaluating at step 700... (Time: 2025-04-20 11:22:27)
Evaluation results: {'precision': 0.1480674935064812, 'recall': 0.16835699797160245, 'f1': 0.13966482314843642}
New best F1: 0.1397, saving model...
Epoch 20 average loss: 1.7316
Evaluating after epoch 20...
Evaluation results: {'precision': 0.09926530005528383, 'recall': 0.13640973630831643, 'f1': 0.11060355870099436}
Saving checkpoint at end of epoch 20...
Epoch 21/100
Epoch 21 average loss: 1.6858
Evaluating after epoch 21...
Evaluation results: {'precision': 0.161180320204732, 'recall': 0.16886409736308317, 'f1': 0.14876824652209364}
Saving checkpoint at end of epoch 21...
Epoch 22/100
Epoch 22 average loss: 1.5775
Evaluating after epoch 22...
Evaluation results: {'precision': 0.18502905069674866, 'recall': 0.21095334685598377, 'f1': 0.17783857769181735}
Saving checkpoint at end of epoch 22...
Epoch 23/100
Step 800/3600 - Loss: 0.0154

Evaluating at step 800... (Time: 2025-04-20 11:25:15)
Evaluation results: {'precision': 0.08142350225467632, 'recall': 0.14249492900608518, 'f1': 0.09982571869484173}
Epoch 23 average loss: 1.4517
Evaluating after epoch 23...
Evaluation results: {'precision': 0.1775814305103782, 'recall': 0.13843813387423934, 'f1': 0.12886768465278375}
Saving checkpoint at end of epoch 23...
Epoch 24/100
Epoch 24 average loss: 1.4173
Evaluating after epoch 24...
Evaluation results: {'precision': 0.14298913636300822, 'recall': 0.19320486815415822, 'f1': 0.15183146479916312}
Saving checkpoint at end of epoch 24...
Epoch 25/100
Step 900/3600 - Loss: 0.0527

Evaluating at step 900... (Time: 2025-04-20 11:27:29)
Evaluation results: {'precision': 0.12373921664988514, 'recall': 0.1460446247464503, 'f1': 0.11853466141525354}
Epoch 25 average loss: 1.3163
Evaluating after epoch 25...
Evaluation results: {'precision': 0.12373921664988514, 'recall': 0.1460446247464503, 'f1': 0.11853466141525354}
Saving checkpoint at end of epoch 25...
Epoch 26/100
Epoch 26 average loss: 1.2701
Evaluating after epoch 26...
Evaluation results: {'precision': 0.1410211354874212, 'recall': 0.1440162271805274, 'f1': 0.12894169862341337}
Saving checkpoint at end of epoch 26...
Epoch 27/100
Epoch 27 average loss: 1.1723
Evaluating after epoch 27...
Evaluation results: {'precision': 0.17040511734252922, 'recall': 0.20537525354969574, 'f1': 0.1700023397342174}
Saving checkpoint at end of epoch 27...
Epoch 28/100
Step 1000/3600 - Loss: 0.0308

Evaluating at step 1000... (Time: 2025-04-20 11:30:17)
Evaluation results: {'precision': 0.12904163419918313, 'recall': 0.14148073022312374, 'f1': 0.11213725772523274}
Early stopping triggered. No improvement for 8 evaluations.
Best performance was at epoch 22 with F1: 0.1778
Epoch 28 average loss: 0.8565
Evaluating after epoch 28...
Evaluation results: {'precision': 0.12904163419918313, 'recall': 0.14148073022312374, 'f1': 0.11213725772523274}
Early stopping triggered after epoch 28.
Best performance was at epoch 22 with F1: 0.1778
Training complete. Saving final model...
Best F1: 0.1397
Model saved to layoutlmv3/model/train-20250420_110256
Training completed at: 2025-04-20 11:30:31
Generating training visualizations...
