Early stopping enabled with patience=8, min_delta=0.0001
Training started at: 2025-04-21 06:21:01
Parameters: {'dataset_dir': 'CUAD_v1/layoutlmv3_dataset_part1', 'output_dir': 'layoutlmv3/model/train-20250421_062101', 'model_name': 'microsoft/layoutlmv3-base', 'processor_dir': None, 'batch_size': 8, 'learning_rate': 5e-05, 'num_epochs': 100, 'max_seq_length': 512, 'warmup_ratio': 0.1, 'weight_decay': 0.01, 'save_steps': 100, 'eval_steps': 100, 'checkpoint_steps': 500, 'seed': 42, 'device': 'cuda', 'num_workers': 0, 'resume_from': None, 'early_stopping': True, 'patience': 8, 'min_delta': 0.0001}
Loading model microsoft/layoutlmv3-base...
Creating new processor with OCR disabled...
Saving processor to layoutlmv3/model/train-20250421_062101/processor...
Creating data loaders (batch_size=8, num_workers=0)...
Starting/Resuming training with 5000 total steps...
Epoch 1/100
Epoch 1 average loss: 3.6568
Evaluating after epoch 1...
Evaluation results: {'precision': 0.022391720197543943, 'recall': 0.10534069981583793, 'f1': 0.029325186531403667}
Saving checkpoint at end of epoch 1...
Epoch 2/100
Step 100/5000 - Loss: 1.6926

Evaluating at step 100... (Time: 2025-04-21 06:23:55)
Evaluation results: {'precision': 0.016613984028872642, 'recall': 0.11049723756906077, 'f1': 0.025810666322795984}
New best F1: 0.0258, saving model...
Epoch 2 average loss: 3.3852
Evaluating after epoch 2...
Evaluation results: {'precision': 0.016613984028872642, 'recall': 0.11049723756906077, 'f1': 0.025810666322795984}
Saving checkpoint at end of epoch 2...
Epoch 3/100
Epoch 3 average loss: 3.1676
Evaluating after epoch 3...
Evaluation results: {'precision': 0.04607144873920701, 'recall': 0.17716390423572745, 'f1': 0.07284225589573069}
Saving checkpoint at end of epoch 3...
Epoch 4/100
Step 200/5000 - Loss: 0.7466

Evaluating at step 200... (Time: 2025-04-21 06:26:57)
Evaluation results: {'precision': 0.031077403746567814, 'recall': 0.1311233885819521, 'f1': 0.05001556002693876}
New best F1: 0.0500, saving model...
Epoch 4 average loss: 2.9865
Evaluating after epoch 4...
Evaluation results: {'precision': 0.031077403746567814, 'recall': 0.1311233885819521, 'f1': 0.05001556002693876}
Saving checkpoint at end of epoch 4...
Epoch 5/100
Epoch 5 average loss: 2.8584
Evaluating after epoch 5...
Evaluation results: {'precision': 0.05452917368176364, 'recall': 0.15211786372007366, 'f1': 0.07456065552000456}
Saving checkpoint at end of epoch 5...
Epoch 6/100
Step 300/5000 - Loss: 0.4528

Evaluating at step 300... (Time: 2025-04-21 06:29:59)
Evaluation results: {'precision': 0.06143773288910294, 'recall': 0.16500920810313074, 'f1': 0.08764114664393462}
New best F1: 0.0876, saving model...
Epoch 6 average loss: 2.7169
Evaluating after epoch 6...
Evaluation results: {'precision': 0.06143773288910294, 'recall': 0.16500920810313074, 'f1': 0.08764114664393462}
Saving checkpoint at end of epoch 6...
Epoch 7/100
Epoch 7 average loss: 2.6445
Evaluating after epoch 7...
Evaluation results: {'precision': 0.04166001845744165, 'recall': 0.14475138121546963, 'f1': 0.057490430765887356}
Saving checkpoint at end of epoch 7...
Epoch 8/100
Step 400/5000 - Loss: 0.3276

Evaluating at step 400... (Time: 2025-04-21 06:32:43)
Evaluation results: {'precision': 0.08399511585439845, 'recall': 0.16132596685082873, 'f1': 0.10067944863243637}
New best F1: 0.1007, saving model...
Epoch 8 average loss: 2.6207
Evaluating after epoch 8...
Evaluation results: {'precision': 0.08399511585439845, 'recall': 0.16132596685082873, 'f1': 0.10067944863243637}
Saving checkpoint at end of epoch 8...
Epoch 9/100
Epoch 9 average loss: 2.5225
Evaluating after epoch 9...
Evaluation results: {'precision': 0.09084662234302476, 'recall': 0.15543278084714549, 'f1': 0.1023513591727123}
Saving checkpoint at end of epoch 9...
Epoch 10/100
Step 500/5000 - Loss: 0.2406

Evaluating at step 500... (Time: 2025-04-21 06:35:26)
Evaluation results: {'precision': 0.07189477685307705, 'recall': 0.16095764272559854, 'f1': 0.09299584603252949}
Epoch 10 average loss: 2.4060
Evaluating after epoch 10...
Evaluation results: {'precision': 0.07189477685307705, 'recall': 0.16095764272559854, 'f1': 0.09299584603252949}
Saving checkpoint at end of epoch 10...
Epoch 11/100
Epoch 11 average loss: 2.2980
Evaluating after epoch 11...
Evaluation results: {'precision': 0.12402044525786561, 'recall': 0.13222836095764273, 'f1': 0.10698629261222223}
Saving checkpoint at end of epoch 11...
Epoch 12/100
Step 600/5000 - Loss: 0.1797

Evaluating at step 600... (Time: 2025-04-21 06:38:09)
Evaluation results: {'precision': 0.10333135110286533, 'recall': 0.1558011049723757, 'f1': 0.10158255069119321}
New best F1: 0.1016, saving model...
Epoch 12 average loss: 2.1566
Evaluating after epoch 12...
Evaluation results: {'precision': 0.10333135110286533, 'recall': 0.1558011049723757, 'f1': 0.10158255069119321}
Saving checkpoint at end of epoch 12...
Epoch 13/100
Epoch 13 average loss: 1.9513
Evaluating after epoch 13...
Evaluation results: {'precision': 0.12205336260534148, 'recall': 0.16906077348066298, 'f1': 0.10484806806736297}
Saving checkpoint at end of epoch 13...
Epoch 14/100
Step 700/5000 - Loss: 0.1210

Evaluating at step 700... (Time: 2025-04-21 06:40:52)
Evaluation results: {'precision': 0.1398341773536887, 'recall': 0.13370165745856355, 'f1': 0.10903711184184418}
New best F1: 0.1090, saving model...
Epoch 14 average loss: 1.6936
Evaluating after epoch 14...
Evaluation results: {'precision': 0.1398341773536887, 'recall': 0.13370165745856355, 'f1': 0.10903711184184418}
Saving checkpoint at end of epoch 14...
Epoch 15/100
Epoch 15 average loss: 1.5972
Evaluating after epoch 15...
Evaluation results: {'precision': 0.1657077840192169, 'recall': 0.15469613259668508, 'f1': 0.14948955430553226}
Saving checkpoint at end of epoch 15...
Epoch 16/100
Step 800/5000 - Loss: 0.0735

Evaluating at step 800... (Time: 2025-04-21 06:43:35)
Evaluation results: {'precision': 0.15047974734452316, 'recall': 0.14880294659300183, 'f1': 0.13713478774501192}
New best F1: 0.1371, saving model...
Epoch 16 average loss: 1.1761
Evaluating after epoch 16...
Evaluation results: {'precision': 0.15047974734452316, 'recall': 0.14880294659300183, 'f1': 0.13713478774501192}
Saving checkpoint at end of epoch 16...
Epoch 17/100
Epoch 17 average loss: 0.9699
Evaluating after epoch 17...
Evaluation results: {'precision': 0.18371173744579622, 'recall': 0.15211786372007366, 'f1': 0.1401051747818383}
Saving checkpoint at end of epoch 17...
Epoch 18/100
Step 900/5000 - Loss: 0.0367

Evaluating at step 900... (Time: 2025-04-21 06:46:19)
Evaluation results: {'precision': 0.17784781626756305, 'recall': 0.13406998158379374, 'f1': 0.1340491426619581}
Epoch 18 average loss: 0.6598
Evaluating after epoch 18...
Evaluation results: {'precision': 0.17784781626756305, 'recall': 0.13406998158379374, 'f1': 0.1340491426619581}
Saving checkpoint at end of epoch 18...
Epoch 19/100
Epoch 19 average loss: 0.4862
Evaluating after epoch 19...
Evaluation results: {'precision': 0.20045297382899183, 'recall': 0.1406998158379374, 'f1': 0.1484012923240963}
Saving checkpoint at end of epoch 19...
Epoch 20/100
Step 1000/5000 - Loss: 0.0178

Evaluating at step 1000... (Time: 2025-04-21 06:49:02)
Evaluation results: {'precision': 0.13502256763756618, 'recall': 0.1443830570902394, 'f1': 0.12102397573596974}
Epoch 20 average loss: 0.3560
Evaluating after epoch 20...
Evaluation results: {'precision': 0.13502256763756618, 'recall': 0.1443830570902394, 'f1': 0.12102397573596974}
Early stopping triggered after epoch 20.
Best performance was at epoch 15 with F1: 0.1495
Training complete. Saving final model...
Best F1: 0.1371
Model saved to layoutlmv3/model/train-20250421_062101
Training completed at: 2025-04-21 06:49:23
Generating training visualizations...
