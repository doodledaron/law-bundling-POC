Early stopping enabled with patience=8, min_delta=0.0001
Training started at: 2025-04-20 09:42:08
Parameters: {'dataset_dir': 'CUAD_v1/layoutlmv3_dataset', 'output_dir': 'layoutlmv3/model/train-20250420_094208', 'model_name': 'microsoft/layoutlmv3-base', 'processor_dir': None, 'batch_size': 4, 'learning_rate': 5e-06, 'num_epochs': 100, 'max_seq_length': 512, 'warmup_ratio': 0.1, 'weight_decay': 0.01, 'save_steps': 100, 'eval_steps': 100, 'checkpoint_steps': 500, 'seed': 42, 'device': 'cuda', 'num_workers': 0, 'resume_from': None, 'early_stopping': True, 'patience': 8, 'min_delta': 0.0001}
Loading model microsoft/layoutlmv3-base...
Creating new processor with OCR disabled...
Saving processor to layoutlmv3/model/train-20250420_094208/processor...
Creating data loaders (batch_size=4, num_workers=0)...
Starting/Resuming training with 7200 total steps...
Epoch 1/100
Epoch 1 average loss: 3.6886
Evaluating after epoch 1...
Evaluation results: {'precision': 0.10113309460147574, 'recall': 0.032454361054766734, 'f1': 0.021091578968021607}
Saving checkpoint at end of epoch 1...
Epoch 2/100
Step 100/7200 - Loss: 1.0260

Evaluating at step 100... (Time: 2025-04-20 09:44:07)
Evaluation results: {'precision': 0.11932407058670601, 'recall': 0.03955375253549696, 'f1': 0.02364232737352244}
New best F1: 0.0236, saving model...
Epoch 2 average loss: 3.6428
Evaluating after epoch 2...
Evaluation results: {'precision': 0.030406799227991575, 'recall': 0.048174442190669374, 'f1': 0.016710572619929608}
Saving checkpoint at end of epoch 2...
Epoch 3/100
Step 200/7200 - Loss: 1.0046

Evaluating at step 200... (Time: 2025-04-20 09:45:33)
Evaluation results: {'precision': 0.047461928909923484, 'recall': 0.05933062880324544, 'f1': 0.016273436251577747}
Epoch 3 average loss: 3.5684
Evaluating after epoch 3...
Evaluation results: {'precision': 0.059500262122299294, 'recall': 0.05933062880324544, 'f1': 0.01617457652197321}
Saving checkpoint at end of epoch 3...
Epoch 4/100
Epoch 4 average loss: 3.4215
Evaluating after epoch 4...
Evaluation results: {'precision': 0.024987449444074952, 'recall': 0.07606490872210954, 'f1': 0.020375561619814894}
Saving checkpoint at end of epoch 4...
Epoch 5/100
Step 300/7200 - Loss: 0.1305

Evaluating at step 300... (Time: 2025-04-20 09:47:20)
Evaluation results: {'precision': 0.01951650351230984, 'recall': 0.08874239350912778, 'f1': 0.020605475898103503}
Epoch 5 average loss: 3.2159
Evaluating after epoch 5...
Evaluation results: {'precision': 0.027176065123065835, 'recall': 0.09127789046653144, 'f1': 0.031093454544258305}
Saving checkpoint at end of epoch 5...
Epoch 6/100
Step 400/7200 - Loss: 0.3144

Evaluating at step 400... (Time: 2025-04-20 09:48:35)
Evaluation results: {'precision': 0.022829263281687093, 'recall': 0.11815415821501014, 'f1': 0.030338643498044403}
New best F1: 0.0303, saving model...
Epoch 6 average loss: 3.0976
Evaluating after epoch 6...
Evaluation results: {'precision': 0.024328788743945774, 'recall': 0.1242393509127789, 'f1': 0.04005249997159648}
Saving checkpoint at end of epoch 6...
Epoch 7/100
Step 500/7200 - Loss: 0.4112

Evaluating at step 500... (Time: 2025-04-20 09:49:48)
Evaluation results: {'precision': 0.06063636827832867, 'recall': 0.14553752535496958, 'f1': 0.07366145281505844}
New best F1: 0.0737, saving model...
Epoch 7 average loss: 3.0454
Evaluating after epoch 7...
Evaluation results: {'precision': 0.07413131995389417, 'recall': 0.16379310344827586, 'f1': 0.09590920633115932}
Saving checkpoint at end of epoch 7...
Epoch 8/100
Epoch 8 average loss: 2.9750
Evaluating after epoch 8...
Evaluation results: {'precision': 0.026142026802212802, 'recall': 0.13184584178498987, 'f1': 0.043185782479488295}
Saving checkpoint at end of epoch 8...
Epoch 9/100
Step 600/7200 - Loss: 0.1122

Evaluating at step 600... (Time: 2025-04-20 09:51:37)
Evaluation results: {'precision': 0.029913072668581953, 'recall': 0.1359026369168357, 'f1': 0.04865115887073786}
Epoch 9 average loss: 2.7955
Evaluating after epoch 9...
Evaluation results: {'precision': 0.05914678102858182, 'recall': 0.13488843813387424, 'f1': 0.07558452606549435}
Saving checkpoint at end of epoch 9...
Epoch 10/100
Step 700/7200 - Loss: 0.2086

Evaluating at step 700... (Time: 2025-04-20 09:52:49)
Evaluation results: {'precision': 0.038801616472438426, 'recall': 0.13032454361054766, 'f1': 0.05939390286162044}
Epoch 10 average loss: 2.7622
Evaluating after epoch 10...
Evaluation results: {'precision': 0.04471669284245349, 'recall': 0.1308316430020284, 'f1': 0.06172886397082204}
Saving checkpoint at end of epoch 10...
Epoch 11/100
Epoch 11 average loss: 2.6284
Evaluating after epoch 11...
Evaluation results: {'precision': 0.049304940882759836, 'recall': 0.15365111561866127, 'f1': 0.07199144995831505}
Saving checkpoint at end of epoch 11...
Epoch 12/100
Step 800/7200 - Loss: 0.0239

Evaluating at step 800... (Time: 2025-04-20 09:54:38)
Evaluation results: {'precision': 0.07394645355614833, 'recall': 0.15212981744421908, 'f1': 0.09485121647100461}
New best F1: 0.0949, saving model...
Epoch 12 average loss: 2.4803
Evaluating after epoch 12...
Evaluation results: {'precision': 0.0558227677572898, 'recall': 0.13133874239350912, 'f1': 0.07383446157476756}
Early stopping triggered after epoch 12.
Best performance was at epoch 7 with F1: 0.0959
Training complete. Saving final model...
Best F1: 0.0949
Model saved to layoutlmv3/model/train-20250420_094208
Training completed at: 2025-04-20 09:55:12
Generating training visualizations...
