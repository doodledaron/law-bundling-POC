Early stopping enabled with patience=8, min_delta=0.0001
Training started at: 2025-04-21 02:47:48
Parameters: {'dataset_dir': 'CUAD_v1/layoutlmv3_dataset', 'output_dir': 'layoutlmv3/model/train-20250421_024748', 'model_name': 'microsoft/layoutlmv3-base', 'processor_dir': None, 'batch_size': 4, 'learning_rate': 5e-05, 'num_epochs': 100, 'max_seq_length': 512, 'warmup_ratio': 0.1, 'weight_decay': 0.01, 'save_steps': 100, 'eval_steps': 100, 'checkpoint_steps': 500, 'seed': 42, 'device': 'cuda', 'num_workers': 0, 'resume_from': None, 'early_stopping': True, 'patience': 8, 'min_delta': 0.0001}
Loading model microsoft/layoutlmv3-base...
Creating new processor with OCR disabled...
Saving processor to layoutlmv3/model/train-20250421_024748/processor...
Creating data loaders (batch_size=4, num_workers=0)...
Starting/Resuming training with 7200 total steps...
Epoch 1/100
Epoch 1 average loss: 3.6399
Evaluating after epoch 1...
Evaluation results: {'precision': 0.028497864809008358, 'recall': 0.06643002028397565, 'f1': 0.026351027354909965}
Saving checkpoint at end of epoch 1...
Epoch 2/100
Step 100/7200 - Loss: 0.9559

Evaluating at step 100... (Time: 2025-04-21 02:49:40)
Evaluation results: {'precision': 0.0231892442902943, 'recall': 0.09533468559837728, 'f1': 0.02676142940485838}
New best F1: 0.0268, saving model...
Epoch 2 average loss: 3.3058
Evaluating after epoch 2...
Evaluation results: {'precision': 0.02824332545793436, 'recall': 0.1308316430020284, 'f1': 0.046457054825280494}
Saving checkpoint at end of epoch 2...
Epoch 3/100
Step 200/7200 - Loss: 0.8865

Evaluating at step 200... (Time: 2025-04-21 02:51:06)
Evaluation results: {'precision': 0.033623768307167186, 'recall': 0.10496957403651115, 'f1': 0.04054833314439622}
New best F1: 0.0405, saving model...
Epoch 3 average loss: 3.1038
Evaluating after epoch 3...
Evaluation results: {'precision': 0.039973873569743676, 'recall': 0.12119675456389452, 'f1': 0.03828937521569616}
Saving checkpoint at end of epoch 3...
Epoch 4/100
Epoch 4 average loss: 2.9857
Evaluating after epoch 4...
Evaluation results: {'precision': 0.03924844188316807, 'recall': 0.1343813387423935, 'f1': 0.05624880107337427}
Saving checkpoint at end of epoch 4...
Epoch 5/100
Step 300/7200 - Loss: 0.1164

Evaluating at step 300... (Time: 2025-04-21 02:53:06)
Evaluation results: {'precision': 0.04197186834199662, 'recall': 0.12931034482758622, 'f1': 0.053828082119246556}
New best F1: 0.0538, saving model...
Epoch 5 average loss: 2.8429
Evaluating after epoch 5...
Evaluation results: {'precision': 0.0443737923792932, 'recall': 0.10801217038539554, 'f1': 0.0419190125961547}
Saving checkpoint at end of epoch 5...
Epoch 6/100
Step 400/7200 - Loss: 0.2702

Evaluating at step 400... (Time: 2025-04-21 02:54:19)
Evaluation results: {'precision': 0.040637524765227036, 'recall': 0.12778904665314403, 'f1': 0.05833397513294876}
New best F1: 0.0583, saving model...
Epoch 6 average loss: 2.7160
Evaluating after epoch 6...
Evaluation results: {'precision': 0.026216822107719577, 'recall': 0.11257606490872211, 'f1': 0.04228187345543953}
Saving checkpoint at end of epoch 6...
Epoch 7/100
Step 500/7200 - Loss: 0.3586

Evaluating at step 500... (Time: 2025-04-21 02:55:41)
Evaluation results: {'precision': 0.1251971946064992, 'recall': 0.19776876267748478, 'f1': 0.1403840352310098}
New best F1: 0.1404, saving model...
Epoch 7 average loss: 2.6819
Evaluating after epoch 7...
Evaluation results: {'precision': 0.06977704305353376, 'recall': 0.12170385395537525, 'f1': 0.06511523695379116}
Saving checkpoint at end of epoch 7...
Epoch 8/100
Epoch 8 average loss: 2.6324
Evaluating after epoch 8...
Evaluation results: {'precision': 0.0415032645419044, 'recall': 0.12778904665314403, 'f1': 0.05584481616263845}
Saving checkpoint at end of epoch 8...
Epoch 9/100
Step 600/7200 - Loss: 0.0896

Evaluating at step 600... (Time: 2025-04-21 02:57:30)
Evaluation results: {'precision': 0.089992882911933, 'recall': 0.13133874239350912, 'f1': 0.06625311089214168}
Epoch 9 average loss: 2.3218
Evaluating after epoch 9...
Evaluation results: {'precision': 0.15779399213155976, 'recall': 0.1460446247464503, 'f1': 0.12190039536891265}
Saving checkpoint at end of epoch 9...
Epoch 10/100
Step 700/7200 - Loss: 0.1714

Evaluating at step 700... (Time: 2025-04-21 02:58:42)
Evaluation results: {'precision': 0.07534374772389452, 'recall': 0.13843813387423934, 'f1': 0.07815517554947227}
Epoch 10 average loss: 2.2934
Evaluating after epoch 10...
Evaluation results: {'precision': 0.147580038544359, 'recall': 0.2449290060851927, 'f1': 0.1616179337386615}
Saving checkpoint at end of epoch 10...
Epoch 11/100
Epoch 11 average loss: 2.1440
Evaluating after epoch 11...
Evaluation results: {'precision': 0.06355613041557552, 'recall': 0.15060851926977686, 'f1': 0.08462199861996197}
Saving checkpoint at end of epoch 11...
Epoch 12/100
Step 800/7200 - Loss: 0.0191

Evaluating at step 800... (Time: 2025-04-21 03:00:29)
Evaluation results: {'precision': 0.1814143089848048, 'recall': 0.19168356997971603, 'f1': 0.16689739545157511}
New best F1: 0.1669, saving model...
Epoch 12 average loss: 1.8167
Evaluating after epoch 12...
Evaluation results: {'precision': 0.2060444707677071, 'recall': 0.19878296146044624, 'f1': 0.16104026695266985}
Saving checkpoint at end of epoch 12...
Epoch 13/100
Step 900/7200 - Loss: 0.0662

Evaluating at step 900... (Time: 2025-04-21 03:01:42)
Evaluation results: {'precision': 0.17780640741915107, 'recall': 0.1389452332657201, 'f1': 0.1293338668482842}
Epoch 13 average loss: 1.5732
Evaluating after epoch 13...
Evaluation results: {'precision': 0.1787432061516595, 'recall': 0.19827586206896552, 'f1': 0.1622904560235901}
Saving checkpoint at end of epoch 13...
Epoch 14/100
Step 1000/7200 - Loss: 0.0930

Evaluating at step 1000... (Time: 2025-04-21 03:02:54)
Evaluation results: {'precision': 0.1279197282838743, 'recall': 0.13336713995943206, 'f1': 0.10102477329507098}
Epoch 14 average loss: 1.4290
Evaluating after epoch 14...
Evaluation results: {'precision': 0.1891805501860694, 'recall': 0.1475659229208925, 'f1': 0.12768094621084106}
Saving checkpoint at end of epoch 14...
Epoch 15/100
Epoch 15 average loss: 1.2638
Evaluating after epoch 15...
Evaluation results: {'precision': 0.22223031449711075, 'recall': 0.172920892494929, 'f1': 0.17140979364981715}
Saving checkpoint at end of epoch 15...
Epoch 16/100
Step 1100/7200 - Loss: 0.0168

Evaluating at step 1100... (Time: 2025-04-21 03:04:41)
Evaluation results: {'precision': 0.14328531868528085, 'recall': 0.14452332657200812, 'f1': 0.12516151735434874}
Epoch 16 average loss: 0.9471
Evaluating after epoch 16...
Evaluation results: {'precision': 0.07351676895168721, 'recall': 0.10598377281947262, 'f1': 0.08033227101800175}
Saving checkpoint at end of epoch 16...
Epoch 17/100
Step 1200/7200 - Loss: 0.0304

Evaluating at step 1200... (Time: 2025-04-21 03:05:53)
Evaluation results: {'precision': 0.2009946215010341, 'recall': 0.17849898580121704, 'f1': 0.16045188560391876}
Epoch 17 average loss: 0.7124
Evaluating after epoch 17...
Evaluation results: {'precision': 0.1380841608093555, 'recall': 0.12373225152129817, 'f1': 0.10901879768280776}
Saving checkpoint at end of epoch 17...
Epoch 18/100
Epoch 18 average loss: 0.5166
Evaluating after epoch 18...
Evaluation results: {'precision': 0.12665867991680121, 'recall': 0.14249492900608518, 'f1': 0.12279388818767163}
Saving checkpoint at end of epoch 18...
Epoch 19/100
Step 1300/7200 - Loss: 0.0011

Evaluating at step 1300... (Time: 2025-04-21 03:07:40)
Evaluation results: {'precision': 0.1699168237159915, 'recall': 0.15314401622718052, 'f1': 0.1379110485337682}
Epoch 19 average loss: 0.3166
Evaluating after epoch 19...
Evaluation results: {'precision': 0.15439107784218395, 'recall': 0.14858012170385396, 'f1': 0.13875996803126775}
Saving checkpoint at end of epoch 19...
Epoch 20/100
Step 1400/7200 - Loss: 0.0063

Evaluating at step 1400... (Time: 2025-04-21 03:08:52)
Evaluation results: {'precision': 0.1601466459801075, 'recall': 0.16835699797160245, 'f1': 0.1544782989935597}
Early stopping triggered. No improvement for 8 evaluations.
Best performance was at epoch 15 with F1: 0.1714
Epoch 20 average loss: 0.1228
Evaluating after epoch 20...
Evaluation results: {'precision': 0.1601466459801075, 'recall': 0.16835699797160245, 'f1': 0.1544782989935597}
Early stopping triggered after epoch 20.
Best performance was at epoch 15 with F1: 0.1714
Training complete. Saving final model...
Best F1: 0.1669
Model saved to layoutlmv3/model/train-20250421_024748
Training completed at: 2025-04-21 03:09:06
Generating training visualizations...
