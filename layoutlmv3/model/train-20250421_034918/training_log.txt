Early stopping enabled with patience=8, min_delta=0.0001
Training started at: 2025-04-21 03:49:18
Parameters: {'dataset_dir': 'CUAD_v1/layoutlmv3_dataset', 'output_dir': 'layoutlmv3/model/train-20250421_034918', 'model_name': 'microsoft/layoutlmv3-base', 'processor_dir': None, 'batch_size': 8, 'learning_rate': 5e-05, 'num_epochs': 100, 'max_seq_length': 512, 'warmup_ratio': 0.1, 'weight_decay': 0.01, 'save_steps': 100, 'eval_steps': 100, 'checkpoint_steps': 500, 'seed': 42, 'device': 'cuda', 'num_workers': 0, 'resume_from': None, 'early_stopping': True, 'patience': 8, 'min_delta': 0.0001}
Loading model microsoft/layoutlmv3-base...
Creating new processor with OCR disabled...
Saving processor to layoutlmv3/model/train-20250421_034918/processor...
Creating data loaders (batch_size=8, num_workers=0)...
Starting/Resuming training with 3600 total steps...
Epoch 1/100
Epoch 1 average loss: 3.6621
Evaluating after epoch 1...
Evaluation results: {'precision': 0.032719645739777405, 'recall': 0.05933062880324544, 'f1': 0.022078769896981272}
Saving checkpoint at end of epoch 1...
Epoch 2/100
Epoch 2 average loss: 3.4487
Evaluating after epoch 2...
Evaluation results: {'precision': 0.030595750517647773, 'recall': 0.10243407707910751, 'f1': 0.04445234202234521}
Saving checkpoint at end of epoch 2...
Epoch 3/100
Step 100/3600 - Loss: 0.8917

Evaluating at step 100... (Time: 2025-04-21 03:52:02)
Evaluation results: {'precision': 0.03357924108480281, 'recall': 0.12271805273833672, 'f1': 0.04890610998862239}
New best F1: 0.0489, saving model...
Epoch 3 average loss: 3.1836
Evaluating after epoch 3...
Evaluation results: {'precision': 0.03311612429079578, 'recall': 0.09330628803245436, 'f1': 0.025853445116117743}
Saving checkpoint at end of epoch 3...
Epoch 4/100
Epoch 4 average loss: 3.0528
Evaluating after epoch 4...
Evaluation results: {'precision': 0.03755335560137303, 'recall': 0.14350912778904665, 'f1': 0.05664479171962753}
Saving checkpoint at end of epoch 4...
Epoch 5/100
Epoch 5 average loss: 2.8703
Evaluating after epoch 5...
Evaluation results: {'precision': 0.04284645924515444, 'recall': 0.1374239350912779, 'f1': 0.06276146934545648}
Saving checkpoint at end of epoch 5...
Epoch 6/100
Step 200/3600 - Loss: 0.2719

Evaluating at step 200... (Time: 2025-04-21 03:54:51)
Evaluation results: {'precision': 0.050230588744883835, 'recall': 0.14198782961460446, 'f1': 0.06516439869298349}
New best F1: 0.0652, saving model...
Epoch 6 average loss: 2.7330
Evaluating after epoch 6...
Evaluation results: {'precision': 0.043262430865784074, 'recall': 0.15010141987829614, 'f1': 0.06693820202591834}
Saving checkpoint at end of epoch 6...
Epoch 7/100
Epoch 7 average loss: 2.6204
Evaluating after epoch 7...
Evaluation results: {'precision': 0.13697284228201131, 'recall': 0.1257606490872211, 'f1': 0.09540574469497992}
Saving checkpoint at end of epoch 7...
Epoch 8/100
Epoch 8 average loss: 2.4814
Evaluating after epoch 8...
Evaluation results: {'precision': 0.08243340713102416, 'recall': 0.20233265720081137, 'f1': 0.10348793728056861}
Saving checkpoint at end of epoch 8...
Epoch 9/100
Step 300/3600 - Loss: 0.0925

Evaluating at step 300... (Time: 2025-04-21 03:57:42)
Evaluation results: {'precision': 0.06112485613452963, 'recall': 0.15365111561866127, 'f1': 0.08625127521902916}
New best F1: 0.0863, saving model...
Epoch 9 average loss: 2.3521
Evaluating after epoch 9...
Evaluation results: {'precision': 0.042724316676025303, 'recall': 0.14148073022312374, 'f1': 0.06446893089578844}
Saving checkpoint at end of epoch 9...
Epoch 10/100
Epoch 10 average loss: 2.1079
Evaluating after epoch 10...
Evaluation results: {'precision': 0.10874844880659018, 'recall': 0.1612576064908722, 'f1': 0.11742644626261604}
Saving checkpoint at end of epoch 10...
Epoch 11/100
Epoch 11 average loss: 2.0664
Evaluating after epoch 11...
Evaluation results: {'precision': 0.1309178292459448, 'recall': 0.15365111561866127, 'f1': 0.13095039945700512}
Saving checkpoint at end of epoch 11...
Epoch 12/100
Step 400/3600 - Loss: 0.0185

Evaluating at step 400... (Time: 2025-04-21 04:00:32)
Evaluation results: {'precision': 0.1236691968553945, 'recall': 0.14553752535496958, 'f1': 0.09591450259537872}
New best F1: 0.0959, saving model...
Epoch 12 average loss: 1.7445
Evaluating after epoch 12...
Evaluation results: {'precision': 0.2208263940838197, 'recall': 0.2150101419878296, 'f1': 0.19172081642831412}
Saving checkpoint at end of epoch 12...
Epoch 13/100
Epoch 13 average loss: 1.6217
Evaluating after epoch 13...
Evaluation results: {'precision': 0.16771460650964784, 'recall': 0.18052738336713997, 'f1': 0.15915932061211266}
Saving checkpoint at end of epoch 13...
Epoch 14/100
Step 500/3600 - Loss: 0.0813

Evaluating at step 500... (Time: 2025-04-21 04:02:48)
Evaluation results: {'precision': 0.3053905683110889, 'recall': 0.2150101419878296, 'f1': 0.2201279343641067}
New best F1: 0.2201, saving model...
Epoch 14 average loss: 1.2389
Evaluating after epoch 14...
Evaluation results: {'precision': 0.20768020881532132, 'recall': 0.18914807302231237, 'f1': 0.17178763979574313}
Saving checkpoint at end of epoch 14...
Epoch 15/100
Epoch 15 average loss: 0.9498
Evaluating after epoch 15...
Evaluation results: {'precision': 0.497854784408823, 'recall': 0.3144016227180527, 'f1': 0.3340073969938286}
Saving checkpoint at end of epoch 15...
Epoch 16/100
Epoch 16 average loss: 0.7974
Evaluating after epoch 16...
Evaluation results: {'precision': 0.2891584821756678, 'recall': 0.30578093306288034, 'f1': 0.2658399459870716}
Saving checkpoint at end of epoch 16...
Epoch 17/100
Step 600/3600 - Loss: 0.0237

Evaluating at step 600... (Time: 2025-04-21 04:05:38)
Evaluation results: {'precision': 0.25553583305383903, 'recall': 0.2667342799188641, 'f1': 0.22905554761875957}
New best F1: 0.2291, saving model...
Epoch 17 average loss: 0.5529
Evaluating after epoch 17...
Evaluation results: {'precision': 0.3080998663764002, 'recall': 0.2601419878296146, 'f1': 0.24084158933279165}
Saving checkpoint at end of epoch 17...
Epoch 18/100
Epoch 18 average loss: 0.4756
Evaluating after epoch 18...
Evaluation results: {'precision': 0.2475154966911675, 'recall': 0.22413793103448276, 'f1': 0.2068449340147696}
Saving checkpoint at end of epoch 18...
Epoch 19/100
Epoch 19 average loss: 0.3472
Evaluating after epoch 19...
Evaluation results: {'precision': 0.3047331812291732, 'recall': 0.2317444219066937, 'f1': 0.22682871836288906}
Saving checkpoint at end of epoch 19...
Epoch 20/100
Step 700/3600 - Loss: 0.0057

Evaluating at step 700... (Time: 2025-04-21 04:08:28)
Evaluation results: {'precision': 0.33907449900970404, 'recall': 0.26419878296146043, 'f1': 0.26591550085793786}
New best F1: 0.2659, saving model...
Epoch 20 average loss: 0.2292
Evaluating after epoch 20...
Evaluation results: {'precision': 0.3409767728686455, 'recall': 0.2778904665314402, 'f1': 0.28008361906200513}
Saving checkpoint at end of epoch 20...
Epoch 21/100
Epoch 21 average loss: 0.1947
Evaluating after epoch 21...
Evaluation results: {'precision': 0.3123805241819689, 'recall': 0.22210953346855983, 'f1': 0.22125015290434055}
Early stopping triggered after epoch 21.
Best performance was at epoch 15 with F1: 0.3340
Training complete. Saving final model...
Best F1: 0.2659
Model saved to layoutlmv3/model/train-20250421_034918
Training completed at: 2025-04-21 04:09:50
Generating training visualizations...
