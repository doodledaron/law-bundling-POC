Early stopping enabled with patience=8, min_delta=0.0001
Training started at: 2025-04-21 05:35:17
Parameters: {'dataset_dir': 'CUAD_v1/layoutlmv3_dataset_part1', 'output_dir': 'layoutlmv3/model/train-20250421_053517', 'model_name': 'microsoft/layoutlmv3-base', 'processor_dir': None, 'batch_size': 4, 'learning_rate': 5e-05, 'num_epochs': 100, 'max_seq_length': 512, 'warmup_ratio': 0.1, 'weight_decay': 0.01, 'save_steps': 100, 'eval_steps': 100, 'checkpoint_steps': 500, 'seed': 42, 'device': 'cuda', 'num_workers': 0, 'resume_from': None, 'early_stopping': True, 'patience': 8, 'min_delta': 0.0001}
Loading model microsoft/layoutlmv3-base...
Creating new processor with OCR disabled...
Saving processor to layoutlmv3/model/train-20250421_053517/processor...
Creating data loaders (batch_size=4, num_workers=0)...
Starting/Resuming training with 10000 total steps...
Epoch 1/100
Step 100/10000 - Loss: 3.6249

Evaluating at step 100... (Time: 2025-04-21 05:36:24)
Evaluation results: {'precision': 0.014278492167289629, 'recall': 0.11307550644567219, 'f1': 0.024778697345677225}
New best F1: 0.0248, saving model...
Epoch 1 average loss: 3.6249
Evaluating after epoch 1...
Evaluation results: {'precision': 0.014278492167289629, 'recall': 0.11307550644567219, 'f1': 0.024778697345677225}
Saving checkpoint at end of epoch 1...
Epoch 2/100
Step 200/10000 - Loss: 1.6564

Evaluating at step 200... (Time: 2025-04-21 05:38:09)
Evaluation results: {'precision': 0.023016907094805146, 'recall': 0.13554327808471456, 'f1': 0.03934741391612811}
New best F1: 0.0393, saving model...
Epoch 2 average loss: 3.3127
Evaluating after epoch 2...
Evaluation results: {'precision': 0.023016907094805146, 'recall': 0.13554327808471456, 'f1': 0.03934741391612811}
Saving checkpoint at end of epoch 2...
Epoch 3/100
Step 300/10000 - Loss: 1.0324

Evaluating at step 300... (Time: 2025-04-21 05:39:59)
Evaluation results: {'precision': 0.11900486804380733, 'recall': 0.15285451197053407, 'f1': 0.0610757039020472}
New best F1: 0.0611, saving model...
Epoch 3 average loss: 3.0973
Evaluating after epoch 3...
Evaluation results: {'precision': 0.11900486804380733, 'recall': 0.15285451197053407, 'f1': 0.0610757039020472}
Saving checkpoint at end of epoch 3...
Epoch 4/100
Step 400/10000 - Loss: 0.7332

Evaluating at step 400... (Time: 2025-04-21 05:41:29)
Evaluation results: {'precision': 0.06159303436807583, 'recall': 0.19558011049723756, 'f1': 0.09056207230448637}
New best F1: 0.0906, saving model...
Epoch 4 average loss: 2.9326
Evaluating after epoch 4...
Evaluation results: {'precision': 0.06159303436807583, 'recall': 0.19558011049723756, 'f1': 0.09056207230448637}
Saving checkpoint at end of epoch 4...
Epoch 5/100
Step 500/10000 - Loss: 0.5649

Evaluating at step 500... (Time: 2025-04-21 05:43:00)
Evaluation results: {'precision': 0.0531992322431319, 'recall': 0.13075506445672191, 'f1': 0.07403182915840253}
Epoch 5 average loss: 2.8246
Evaluating after epoch 5...
Evaluation results: {'precision': 0.0531992322431319, 'recall': 0.13075506445672191, 'f1': 0.07403182915840253}
Saving checkpoint at end of epoch 5...
Epoch 6/100
Step 600/10000 - Loss: 0.4645

Evaluating at step 600... (Time: 2025-04-21 05:44:29)
Evaluation results: {'precision': 0.08098770250552141, 'recall': 0.20736648250460404, 'f1': 0.1012054485194824}
New best F1: 0.1012, saving model...
Epoch 6 average loss: 2.7868
Evaluating after epoch 6...
Evaluation results: {'precision': 0.08098770250552141, 'recall': 0.20736648250460404, 'f1': 0.1012054485194824}
Saving checkpoint at end of epoch 6...
Epoch 7/100
Step 700/10000 - Loss: 0.3798

Evaluating at step 700... (Time: 2025-04-21 05:45:58)
Evaluation results: {'precision': 0.14396588497856996, 'recall': 0.13222836095764273, 'f1': 0.0760581679438709}
Epoch 7 average loss: 2.6586
Evaluating after epoch 7...
Evaluation results: {'precision': 0.14396588497856996, 'recall': 0.13222836095764273, 'f1': 0.0760581679438709}
Saving checkpoint at end of epoch 7...
Epoch 8/100
Step 800/10000 - Loss: 0.3281

Evaluating at step 800... (Time: 2025-04-21 05:47:26)
Evaluation results: {'precision': 0.09174361592968505, 'recall': 0.16095764272559854, 'f1': 0.09924769061962219}
Epoch 8 average loss: 2.6252
Evaluating after epoch 8...
Evaluation results: {'precision': 0.09174361592968505, 'recall': 0.16095764272559854, 'f1': 0.09924769061962219}
Saving checkpoint at end of epoch 8...
Epoch 9/100
Step 900/10000 - Loss: 0.2811

Evaluating at step 900... (Time: 2025-04-21 05:48:54)
Evaluation results: {'precision': 0.059305106488339684, 'recall': 0.14917127071823205, 'f1': 0.06726316010605703}
Epoch 9 average loss: 2.5303
Evaluating after epoch 9...
Evaluation results: {'precision': 0.059305106488339684, 'recall': 0.14917127071823205, 'f1': 0.06726316010605703}
Saving checkpoint at end of epoch 9...
Epoch 10/100
Step 1000/10000 - Loss: 0.2394

Evaluating at step 1000... (Time: 2025-04-21 05:50:23)
Evaluation results: {'precision': 0.10389700661146657, 'recall': 0.14401473296500922, 'f1': 0.11645307070797892}
New best F1: 0.1165, saving model...
Epoch 10 average loss: 2.3937
Evaluating after epoch 10...
Evaluation results: {'precision': 0.10389700661146657, 'recall': 0.14401473296500922, 'f1': 0.11645307070797892}
Saving checkpoint at end of epoch 10...
Epoch 11/100
Step 1100/10000 - Loss: 0.2181

Evaluating at step 1100... (Time: 2025-04-21 05:51:52)
Evaluation results: {'precision': 0.0791268387465839, 'recall': 0.1414364640883978, 'f1': 0.07947777573736124}
Epoch 11 average loss: 2.3991
Evaluating after epoch 11...
Evaluation results: {'precision': 0.0791268387465839, 'recall': 0.1414364640883978, 'f1': 0.07947777573736124}
Saving checkpoint at end of epoch 11...
Epoch 12/100
Step 1200/10000 - Loss: 0.1990

Evaluating at step 1200... (Time: 2025-04-21 05:53:22)
Evaluation results: {'precision': 0.17651274809127646, 'recall': 0.1694290976058932, 'f1': 0.1316249799100749}
New best F1: 0.1316, saving model...
Epoch 12 average loss: 2.3875
Evaluating after epoch 12...
Evaluation results: {'precision': 0.17651274809127646, 'recall': 0.1694290976058932, 'f1': 0.1316249799100749}
Saving checkpoint at end of epoch 12...
Epoch 13/100
Step 1300/10000 - Loss: 0.1671

Evaluating at step 1300... (Time: 2025-04-21 05:54:52)
Evaluation results: {'precision': 0.12537681645507734, 'recall': 0.16611418047882137, 'f1': 0.12456509702714082}
Epoch 13 average loss: 2.1719
Evaluating after epoch 13...
Evaluation results: {'precision': 0.12537681645507734, 'recall': 0.16611418047882137, 'f1': 0.12456509702714082}
Saving checkpoint at end of epoch 13...
Epoch 14/100
Step 1400/10000 - Loss: 0.1458

Evaluating at step 1400... (Time: 2025-04-21 05:56:21)
Evaluation results: {'precision': 0.18014663811617626, 'recall': 0.14659300184162063, 'f1': 0.10505621920414682}
Epoch 14 average loss: 2.0414
Evaluating after epoch 14...
Evaluation results: {'precision': 0.18014663811617626, 'recall': 0.14659300184162063, 'f1': 0.10505621920414682}
Saving checkpoint at end of epoch 14...
Epoch 15/100
Step 1500/10000 - Loss: 0.1206

Evaluating at step 1500... (Time: 2025-04-21 05:57:52)
Evaluation results: {'precision': 0.1436291392057153, 'recall': 0.19558011049723756, 'f1': 0.14670199992920852}
New best F1: 0.1467, saving model...
Epoch 15 average loss: 1.8089
Evaluating after epoch 15...
Evaluation results: {'precision': 0.1436291392057153, 'recall': 0.19558011049723756, 'f1': 0.14670199992920852}
Saving checkpoint at end of epoch 15...
Epoch 16/100
Step 1600/10000 - Loss: 0.0962

Evaluating at step 1600... (Time: 2025-04-21 05:59:22)
Evaluation results: {'precision': 0.19455683610763208, 'recall': 0.17384898710865562, 'f1': 0.158637277223243}
New best F1: 0.1586, saving model...
Epoch 16 average loss: 1.5396
Evaluating after epoch 16...
Evaluation results: {'precision': 0.19455683610763208, 'recall': 0.17384898710865562, 'f1': 0.158637277223243}
Saving checkpoint at end of epoch 16...
Epoch 17/100
Step 1700/10000 - Loss: 0.0774

Evaluating at step 1700... (Time: 2025-04-21 06:00:52)
Evaluation results: {'precision': 0.18072133363282822, 'recall': 0.1576427255985267, 'f1': 0.1512075535102806}
Epoch 17 average loss: 1.3157
Evaluating after epoch 17...
Evaluation results: {'precision': 0.18072133363282822, 'recall': 0.1576427255985267, 'f1': 0.1512075535102806}
Saving checkpoint at end of epoch 17...
Epoch 18/100
Step 1800/10000 - Loss: 0.0589

Evaluating at step 1800... (Time: 2025-04-21 06:02:21)
Evaluation results: {'precision': 0.13670825457619648, 'recall': 0.1406998158379374, 'f1': 0.10776956971987897}
Epoch 18 average loss: 1.0597
Evaluating after epoch 18...
Evaluation results: {'precision': 0.13670825457619648, 'recall': 0.1406998158379374, 'f1': 0.10776956971987897}
Saving checkpoint at end of epoch 18...
Epoch 19/100
Step 1900/10000 - Loss: 0.0470

Evaluating at step 1900... (Time: 2025-04-21 06:03:48)
Evaluation results: {'precision': 0.19037615673172964, 'recall': 0.1558011049723757, 'f1': 0.1346422492204472}
Epoch 19 average loss: 0.8927
Evaluating after epoch 19...
Evaluation results: {'precision': 0.19037615673172964, 'recall': 0.1558011049723757, 'f1': 0.1346422492204472}
Saving checkpoint at end of epoch 19...
Epoch 20/100
Step 2000/10000 - Loss: 0.0354

Evaluating at step 2000... (Time: 2025-04-21 06:05:17)
Evaluation results: {'precision': 0.1479782816311864, 'recall': 0.143646408839779, 'f1': 0.1275046423065765}
Early stopping triggered. No improvement for 8 evaluations.
Best performance was at epoch 16 with F1: 0.1586
Epoch 20 average loss: 0.7078
Evaluating after epoch 20...
Evaluation results: {'precision': 0.1479782816311864, 'recall': 0.143646408839779, 'f1': 0.1275046423065765}
Early stopping triggered after epoch 20.
Best performance was at epoch 16 with F1: 0.1586
Training complete. Saving final model...
Best F1: 0.1586
Model saved to layoutlmv3/model/train-20250421_053517
Training completed at: 2025-04-21 06:05:37
Generating training visualizations...
