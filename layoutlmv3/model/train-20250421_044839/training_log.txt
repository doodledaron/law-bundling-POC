Early stopping enabled with patience=8, min_delta=0.0001
Training started at: 2025-04-21 04:48:39
Parameters: {'dataset_dir': 'CUAD_v1/layoutlmv3_dataset_part1', 'output_dir': 'layoutlmv3/model/train-20250421_044839', 'model_name': 'microsoft/layoutlmv3-base', 'processor_dir': None, 'batch_size': 2, 'learning_rate': 5e-05, 'num_epochs': 100, 'max_seq_length': 512, 'warmup_ratio': 0.1, 'weight_decay': 0.01, 'save_steps': 100, 'eval_steps': 100, 'checkpoint_steps': 500, 'seed': 42, 'device': 'cuda', 'num_workers': 0, 'resume_from': None, 'early_stopping': True, 'patience': 8, 'min_delta': 0.0001}
Loading model microsoft/layoutlmv3-base...
Creating new processor with OCR disabled...
Saving processor to layoutlmv3/model/train-20250421_044839/processor...
Creating data loaders (batch_size=2, num_workers=0)...
Starting/Resuming training with 20000 total steps...
Epoch 1/100
Step 100/20000 - Loss: 3.6691

Evaluating at step 100... (Time: 2025-04-21 04:49:32)
Evaluation results: {'precision': 0.02396826737273989, 'recall': 0.08176795580110498, 'f1': 0.03177838567269161}
New best F1: 0.0318, saving model...
Step 200/20000 - Loss: 3.5631

Evaluating at step 200... (Time: 2025-04-21 04:50:01)
Evaluation results: {'precision': 0.013063876597735872, 'recall': 0.1138121546961326, 'f1': 0.023437491370279888}
Epoch 1 average loss: 3.5631
Evaluating after epoch 1...
Evaluation results: {'precision': 0.013063876597735872, 'recall': 0.1138121546961326, 'f1': 0.023437491370279888}
Saving checkpoint at end of epoch 1...
Epoch 2/100
Step 300/20000 - Loss: 1.0798

Evaluating at step 300... (Time: 2025-04-21 04:51:32)
Evaluation results: {'precision': 0.03805975131863149, 'recall': 0.1318600368324125, 'f1': 0.0468901529872977}
New best F1: 0.0469, saving model...
Step 400/20000 - Loss: 1.5979

Evaluating at step 400... (Time: 2025-04-21 04:52:04)
Evaluation results: {'precision': 0.03402846570865472, 'recall': 0.10128913443830571, 'f1': 0.044718450527563264}
Epoch 2 average loss: 3.1957
Evaluating after epoch 2...
Evaluation results: {'precision': 0.03402846570865472, 'recall': 0.10128913443830571, 'f1': 0.044718450527563264}
Saving checkpoint at end of epoch 2...
Epoch 3/100
Step 500/20000 - Loss: 0.5964

Evaluating at step 500... (Time: 2025-04-21 04:53:39)
Evaluation results: {'precision': 0.0956644109031437, 'recall': 0.12486187845303867, 'f1': 0.06373122531410878}
New best F1: 0.0637, saving model...
Step 600/20000 - Loss: 0.9744

Evaluating at step 600... (Time: 2025-04-21 04:54:11)
Evaluation results: {'precision': 0.04037991732984854, 'recall': 0.14917127071823205, 'f1': 0.05997421469186004}
Epoch 3 average loss: 2.9231
Evaluating after epoch 3...
Evaluation results: {'precision': 0.04037991732984854, 'recall': 0.14917127071823205, 'f1': 0.05997421469186004}
Saving checkpoint at end of epoch 3...
Epoch 4/100
Step 700/20000 - Loss: 0.3964

Evaluating at step 700... (Time: 2025-04-21 04:55:45)
Evaluation results: {'precision': 0.06105184661021291, 'recall': 0.13996316758747698, 'f1': 0.08216931680528085}
New best F1: 0.0822, saving model...
Step 800/20000 - Loss: 0.6954

Evaluating at step 800... (Time: 2025-04-21 04:56:15)
Evaluation results: {'precision': 0.05759100600111076, 'recall': 0.15469613259668508, 'f1': 0.07614700637509267}
Epoch 4 average loss: 2.7817
Evaluating after epoch 4...
Evaluation results: {'precision': 0.05759100600111076, 'recall': 0.15469613259668508, 'f1': 0.07614700637509267}
Saving checkpoint at end of epoch 4...
Epoch 5/100
Step 900/20000 - Loss: 0.3094

Evaluating at step 900... (Time: 2025-04-21 04:57:38)
Evaluation results: {'precision': 0.034201144058063765, 'recall': 0.13333333333333333, 'f1': 0.05046686655546332}
Step 1000/20000 - Loss: 0.5553

Evaluating at step 1000... (Time: 2025-04-21 04:58:09)
Evaluation results: {'precision': 0.06252153082345878, 'recall': 0.15101289134438306, 'f1': 0.08324424521709307}
New best F1: 0.0832, saving model...
Epoch 5 average loss: 2.7766
Evaluating after epoch 5...
Evaluation results: {'precision': 0.06252153082345878, 'recall': 0.15101289134438306, 'f1': 0.08324424521709307}
Saving checkpoint at end of epoch 5...
Epoch 6/100
Step 1100/20000 - Loss: 0.2377

Evaluating at step 1100... (Time: 2025-04-21 04:59:44)
Evaluation results: {'precision': 0.057661453551100236, 'recall': 0.14548802946593, 'f1': 0.06734551196501909}
Step 1200/20000 - Loss: 0.4395

Evaluating at step 1200... (Time: 2025-04-21 05:00:12)
Evaluation results: {'precision': 0.08669439634452829, 'recall': 0.14511970534069982, 'f1': 0.1034813628908979}
New best F1: 0.1035, saving model...
Epoch 6 average loss: 2.6372
Evaluating after epoch 6...
Evaluation results: {'precision': 0.08669439634452829, 'recall': 0.14511970534069982, 'f1': 0.1034813628908979}
Saving checkpoint at end of epoch 6...
Epoch 7/100
Step 1300/20000 - Loss: 0.1887

Evaluating at step 1300... (Time: 2025-04-21 05:01:33)
Evaluation results: {'precision': 0.03630478206431599, 'recall': 0.0998158379373849, 'f1': 0.051524659751733086}
Step 1400/20000 - Loss: 0.3688

Evaluating at step 1400... (Time: 2025-04-21 05:02:04)
Evaluation results: {'precision': 0.06248027689383968, 'recall': 0.15837937384898712, 'f1': 0.07724206059069001}
Epoch 7 average loss: 2.5819
Evaluating after epoch 7...
Evaluation results: {'precision': 0.06248027689383968, 'recall': 0.15837937384898712, 'f1': 0.07724206059069001}
Saving checkpoint at end of epoch 7...
Epoch 8/100
Step 1500/20000 - Loss: 0.1652

Evaluating at step 1500... (Time: 2025-04-21 05:03:40)
Evaluation results: {'precision': 0.11259428960104631, 'recall': 0.16390423572744015, 'f1': 0.10516072115526659}
New best F1: 0.1052, saving model...
Step 1600/20000 - Loss: 0.3121

Evaluating at step 1600... (Time: 2025-04-21 05:04:11)
Evaluation results: {'precision': 0.12436441567084991, 'recall': 0.1425414364640884, 'f1': 0.1122413540673232}
New best F1: 0.1122, saving model...
Epoch 8 average loss: 2.4969
Evaluating after epoch 8...
Evaluation results: {'precision': 0.12436441567084991, 'recall': 0.1425414364640884, 'f1': 0.1122413540673232}
Saving checkpoint at end of epoch 8...
Epoch 9/100
Step 1700/20000 - Loss: 0.1391

Evaluating at step 1700... (Time: 2025-04-21 05:05:47)
Evaluation results: {'precision': 0.10699969091891719, 'recall': 0.13885819521178638, 'f1': 0.10117417434450687}
Step 1800/20000 - Loss: 0.2658

Evaluating at step 1800... (Time: 2025-04-21 05:06:18)
Evaluation results: {'precision': 0.1112328634672204, 'recall': 0.1697974217311234, 'f1': 0.10088973075537344}
Epoch 9 average loss: 2.3923
Evaluating after epoch 9...
Evaluation results: {'precision': 0.1112328634672204, 'recall': 0.1697974217311234, 'f1': 0.10088973075537344}
Saving checkpoint at end of epoch 9...
Epoch 10/100
Step 1900/20000 - Loss: 0.1144

Evaluating at step 1900... (Time: 2025-04-21 05:07:53)
Evaluation results: {'precision': 0.07119894581939049, 'recall': 0.20810313075506445, 'f1': 0.09956308850192441}
Step 2000/20000 - Loss: 0.2334

Evaluating at step 2000... (Time: 2025-04-21 05:08:24)
Evaluation results: {'precision': 0.1499836004245996, 'recall': 0.16095764272559854, 'f1': 0.10363342275711998}
Epoch 10 average loss: 2.3340
Evaluating after epoch 10...
Evaluation results: {'precision': 0.1499836004245996, 'recall': 0.16095764272559854, 'f1': 0.10363342275711998}
Saving checkpoint at end of epoch 10...
Epoch 11/100
Step 2100/20000 - Loss: 0.1041

Evaluating at step 2100... (Time: 2025-04-21 05:09:59)
Evaluation results: {'precision': 0.12925360225959764, 'recall': 0.1837937384898711, 'f1': 0.12779216349468883}
New best F1: 0.1278, saving model...
Step 2200/20000 - Loss: 0.2070

Evaluating at step 2200... (Time: 2025-04-21 05:10:30)
Evaluation results: {'precision': 0.16636899307930098, 'recall': 0.13480662983425415, 'f1': 0.11902135821612703}
Epoch 11 average loss: 2.2774
Evaluating after epoch 11...
Evaluation results: {'precision': 0.16636899307930098, 'recall': 0.13480662983425415, 'f1': 0.11902135821612703}
Saving checkpoint at end of epoch 11...
Epoch 12/100
Step 2300/20000 - Loss: 0.0874

Evaluating at step 2300... (Time: 2025-04-21 05:12:05)
Evaluation results: {'precision': 0.18390916968775928, 'recall': 0.170902394106814, 'f1': 0.1434381904641497}
New best F1: 0.1434, saving model...
Step 2400/20000 - Loss: 0.1730

Evaluating at step 2400... (Time: 2025-04-21 05:12:37)
Evaluation results: {'precision': 0.14926907418455554, 'recall': 0.170902394106814, 'f1': 0.1225761483078639}
Epoch 12 average loss: 2.0765
Evaluating after epoch 12...
Evaluation results: {'precision': 0.14926907418455554, 'recall': 0.170902394106814, 'f1': 0.1225761483078639}
Saving checkpoint at end of epoch 12...
Epoch 13/100
Step 2500/20000 - Loss: 0.0743

Evaluating at step 2500... (Time: 2025-04-21 05:14:12)
Evaluation results: {'precision': 0.1380998448443818, 'recall': 0.13701657458563535, 'f1': 0.10420425846951825}
Step 2600/20000 - Loss: 0.1439

Evaluating at step 2600... (Time: 2025-04-21 05:14:41)
Evaluation results: {'precision': 0.14576109400052906, 'recall': 0.15174953959484347, 'f1': 0.1337876790313991}
Epoch 13 average loss: 1.8713
Evaluating after epoch 13...
Evaluation results: {'precision': 0.14576109400052906, 'recall': 0.15174953959484347, 'f1': 0.1337876790313991}
Saving checkpoint at end of epoch 13...
Epoch 14/100
Step 2700/20000 - Loss: 0.0578

Evaluating at step 2700... (Time: 2025-04-21 05:16:02)
Evaluation results: {'precision': 0.12243404220951198, 'recall': 0.1561694290976059, 'f1': 0.12694810299087034}
Step 2800/20000 - Loss: 0.1152

Evaluating at step 2800... (Time: 2025-04-21 05:16:33)
Evaluation results: {'precision': 0.23857403161606117, 'recall': 0.16353591160220995, 'f1': 0.12747599553361033}
Epoch 14 average loss: 1.6132
Evaluating after epoch 14...
Evaluation results: {'precision': 0.23857403161606117, 'recall': 0.16353591160220995, 'f1': 0.12747599553361033}
Early stopping triggered after epoch 14.
Best performance was at epoch 12 with F1: 0.1434
Training complete. Saving final model...
Best F1: 0.1434
Model saved to layoutlmv3/model/train-20250421_044839
Training completed at: 2025-04-21 05:17:01
Generating training visualizations...
